<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Point-wise and simultaneous confidence intervals for smooths — confint.gam • gratia</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Point-wise and simultaneous confidence intervals for smooths — confint.gam" />
<meta property="og:description" content="Calculates point-wise confidence or simultaneous intervals for the smooth terms of a fitted GAM." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gratia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Point-wise and simultaneous confidence intervals for smooths</h1>
    
    <div class="hidden name"><code>confint.gam.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates point-wise confidence or simultaneous intervals for the smooth terms of a fitted GAM.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for gam</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(
  <span class='no'>object</span>,
  <span class='no'>parm</span>,
  <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>,
  <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>200</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"confidence"</span>, <span class='st'>"simultaneous"</span>),
  <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
  <span class='kw'>shift</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>transform</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>unconditional</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='no'>...</span>
)

<span class='co'># S3 method for gamm</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>an object of class <code>"gam"</code> or <code>"gamm"</code>.</p></td>
    </tr>
    <tr>
      <th>parm</th>
      <td><p>which parameters (smooth terms) are to be given intervals as a
vector of terms. If missing, all parameters are considered, although this
is not currently implemented.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>numeric, <code>0 &lt; level &lt; 1</code>; the confidence level of the point-wise
or simultaneous interval. The default is <code>0.95</code> for a 95% interval.</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>data frame; containing new values of the covariates used in
the model fit. The selected smooth(s) wil be evaluated at the supplied
values.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>numeric; the number of points to evaluate smooths at.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>character; the type of interval to compute. One of <code>"confidence"</code>
for point-wise intervals, or <code>"simultaneous"</code> for simultaneous intervals.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>integer; the number of simulations used in computing the
simultaneous intervals.</p></td>
    </tr>
    <tr>
      <th>shift</th>
      <td><p>logical; should the constant term be add to the smooth?</p></td>
    </tr>
    <tr>
      <th>transform</th>
      <td><p>logical; should the smooth be evaluated on a transformed
scale? For generalised models, this involves applying the inverse of the
link function used to fit the model. Alternatively, the name of, or an
actual, function can be supplied to transform the smooth and it's
confidence interval.</p></td>
    </tr>
    <tr>
      <th>unconditional</th>
      <td><p>logical; if <code>TRUE</code> (and <code>freq == FALSE</code>) then the
Bayesian smoothing parameter uncertainty corrected covariance matrix is
returned, if available.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>number of cores for generating random variables from a
multivariate normal distribution. Passed to <code><a href='https://rdrr.io/pkg/mvnfast/man/rmvn.html'>mvnfast::rmvn()</a></code>.
Parallelization will take place only if OpenMP is supported (but appears
to work on Windows with current <code>R</code>).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments for methods</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data frame with components:</p><ol>
<li><p><code>term</code>; factor indicating to which term each row relates,</p></li>
<li><p><code>x</code>; the vector of values at which the smooth was evaluated,</p></li>
<li><p><code>lower</code>; lower limit of the confidence or simultaneous interval,</p></li>
<li><p><code>est</code>; estimated value of the smooth</p></li>
<li><p><code>upper</code>; upper limit of the confidence or simultaneous interval,</p></li>
<li><p><code>crit</code>; critical value for the <code>100 * level</code>% confidence interval.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='load_mgcv.html'>load_mgcv</a></span>()
<span class='co'># \dontshow{</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>2</span>)
<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>cli.unicode</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='co'># }</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>gamSim</span>(<span class='fl'>1</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>dist</span> <span class='kw'>=</span> <span class='st'>"normal"</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; Gu &amp; Wahba 4 term additive model</div><div class='input'><span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'>gam</span>(<span class='no'>y</span> ~ <span class='fu'>s</span>(<span class='no'>x0</span>) + <span class='fu'>s</span>(<span class='no'>x1</span>) + <span class='fu'>s</span>(<span class='no'>x2</span>) + <span class='fu'>s</span>(<span class='no'>x3</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"REML"</span>)

<span class='co'>## point-wise interval</span>
<span class='no'>ci</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(<span class='no'>mod</span>, <span class='kw'>parm</span> <span class='kw'>=</span> <span class='st'>"x1"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"confidence"</span>)
<span class='no'>ci</span></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 200 x 8</span><span>
#&gt;    smooth by_variable      x1   est    se  crit lower upper
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.002</span><span style='text-decoration: underline;'>51</span><span> -</span><span style='color: #BB0000;'>2.04</span><span> 0.296  1.96 -</span><span style='color: #BB0000;'>2.62</span><span> -</span><span style='color: #BB0000;'>1.46</span><span>
#&gt; </span><span style='color: #555555;'> 2</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.007</span><span style='text-decoration: underline;'>52</span><span> -</span><span style='color: #BB0000;'>2.04</span><span> 0.287  1.96 -</span><span style='color: #BB0000;'>2.60</span><span> -</span><span style='color: #BB0000;'>1.47</span><span>
#&gt; </span><span style='color: #555555;'> 3</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.012</span><span style='text-decoration: underline;'>5</span><span>  -</span><span style='color: #BB0000;'>2.03</span><span> 0.279  1.96 -</span><span style='color: #BB0000;'>2.58</span><span> -</span><span style='color: #BB0000;'>1.49</span><span>
#&gt; </span><span style='color: #555555;'> 4</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.017</span><span style='text-decoration: underline;'>5</span><span>  -</span><span style='color: #BB0000;'>2.03</span><span> 0.270  1.96 -</span><span style='color: #BB0000;'>2.56</span><span> -</span><span style='color: #BB0000;'>1.50</span><span>
#&gt; </span><span style='color: #555555;'> 5</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.022</span><span style='text-decoration: underline;'>5</span><span>  -</span><span style='color: #BB0000;'>2.02</span><span> 0.262  1.96 -</span><span style='color: #BB0000;'>2.54</span><span> -</span><span style='color: #BB0000;'>1.51</span><span>
#&gt; </span><span style='color: #555555;'> 6</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.027</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.02</span><span> 0.254  1.96 -</span><span style='color: #BB0000;'>2.52</span><span> -</span><span style='color: #BB0000;'>1.52</span><span>
#&gt; </span><span style='color: #555555;'> 7</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.032</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.01</span><span> 0.246  1.96 -</span><span style='color: #BB0000;'>2.50</span><span> -</span><span style='color: #BB0000;'>1.53</span><span>
#&gt; </span><span style='color: #555555;'> 8</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.037</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.01</span><span> 0.239  1.96 -</span><span style='color: #BB0000;'>2.48</span><span> -</span><span style='color: #BB0000;'>1.54</span><span>
#&gt; </span><span style='color: #555555;'> 9</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.042</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.01</span><span> 0.232  1.96 -</span><span style='color: #BB0000;'>2.46</span><span> -</span><span style='color: #BB0000;'>1.55</span><span>
#&gt; </span><span style='color: #555555;'>10</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.047</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.00</span><span> 0.226  1.96 -</span><span style='color: #BB0000;'>2.44</span><span> -</span><span style='color: #BB0000;'>1.56</span><span>
#&gt; </span><span style='color: #555555;'># ... with 190 more rows</span><span></div><div class='input'>
<span class='co'>## simultaneous interval for smooth term of x1</span>
<span class='co'># \dontshow{</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>42</span>)
<span class='co'># }</span>
<span class='no'>si</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(<span class='no'>mod</span>, <span class='kw'>parm</span> <span class='kw'>=</span> <span class='st'>"x1"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"simultaneous"</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>100</span>)
<span class='no'>si</span></div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 200 x 8</span><span>
#&gt;    smooth by_variable      x1   est    se  crit lower upper
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.002</span><span style='text-decoration: underline;'>51</span><span> -</span><span style='color: #BB0000;'>2.04</span><span> 0.296  2.49 -</span><span style='color: #BB0000;'>2.78</span><span> -</span><span style='color: #BB0000;'>1.30</span><span>
#&gt; </span><span style='color: #555555;'> 2</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.007</span><span style='text-decoration: underline;'>52</span><span> -</span><span style='color: #BB0000;'>2.04</span><span> 0.287  2.49 -</span><span style='color: #BB0000;'>2.75</span><span> -</span><span style='color: #BB0000;'>1.32</span><span>
#&gt; </span><span style='color: #555555;'> 3</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.012</span><span style='text-decoration: underline;'>5</span><span>  -</span><span style='color: #BB0000;'>2.03</span><span> 0.279  2.49 -</span><span style='color: #BB0000;'>2.73</span><span> -</span><span style='color: #BB0000;'>1.34</span><span>
#&gt; </span><span style='color: #555555;'> 4</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.017</span><span style='text-decoration: underline;'>5</span><span>  -</span><span style='color: #BB0000;'>2.03</span><span> 0.270  2.49 -</span><span style='color: #BB0000;'>2.70</span><span> -</span><span style='color: #BB0000;'>1.35</span><span>
#&gt; </span><span style='color: #555555;'> 5</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.022</span><span style='text-decoration: underline;'>5</span><span>  -</span><span style='color: #BB0000;'>2.02</span><span> 0.262  2.49 -</span><span style='color: #BB0000;'>2.68</span><span> -</span><span style='color: #BB0000;'>1.37</span><span>
#&gt; </span><span style='color: #555555;'> 6</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.027</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.02</span><span> 0.254  2.49 -</span><span style='color: #BB0000;'>2.65</span><span> -</span><span style='color: #BB0000;'>1.39</span><span>
#&gt; </span><span style='color: #555555;'> 7</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.032</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.01</span><span> 0.246  2.49 -</span><span style='color: #BB0000;'>2.63</span><span> -</span><span style='color: #BB0000;'>1.40</span><span>
#&gt; </span><span style='color: #555555;'> 8</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.037</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.01</span><span> 0.239  2.49 -</span><span style='color: #BB0000;'>2.61</span><span> -</span><span style='color: #BB0000;'>1.41</span><span>
#&gt; </span><span style='color: #555555;'> 9</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.042</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.01</span><span> 0.232  2.49 -</span><span style='color: #BB0000;'>2.58</span><span> -</span><span style='color: #BB0000;'>1.43</span><span>
#&gt; </span><span style='color: #555555;'>10</span><span> s(x1)  </span><span style='color: #BB0000;'>NA</span><span>          0.047</span><span style='text-decoration: underline;'>6</span><span>  -</span><span style='color: #BB0000;'>2.00</span><span> 0.226  2.49 -</span><span style='color: #BB0000;'>2.56</span><span> -</span><span style='color: #BB0000;'>1.44</span><span>
#&gt; </span><span style='color: #555555;'># ... with 190 more rows</span><span></div><div class='input'><span class='co'># \dontshow{</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='no'>op</span>)
<span class='co'># }</span></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Gavin L. Simpson</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gavin L. Simpson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


